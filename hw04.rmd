---
title: "STAT 545A homework 4"
author: "Tian Gao"
date: "2018/10/2"
output: github_document
---

# Bring rectangular data in
```{r}
## load gapminder
library(gapminder)
## load tidyverse
library(tidyverse)
```

# Data Reshaping Prompts (and relationship to aggregation)

# Activity #2

* Make a tibble with one row per year and columns for life expectancy for two or more countries.
* Use knitr::kable() to make this table look pretty in your rendered homework.
* Take advantage of this new data shape to scatterplot life expectancy for one country against that of another.
```{r}

life_contrast<-gapminder %>%
# Filter the country to China and United States
  filter(country %in% c("China","Canada"))%>%
  select(year, country, lifeExp) %>%
# reshape the data, spread the country to columns, lifeExp as the values
  spread(country,lifeExp) %>%
  rename(Year = year)
knitr::kable(
  life_contrast
)
```
* Then I'll do it for different countries, eg the countries of a continent
```{r}
life_contrast_asia <- gapminder %>%
  filter(continent == "Asia") %>%
  select(c("year", "country", "lifeExp")) %>%
  spread(country, lifeExp)

knitr::kable(
  life_contrast_asia
)

```

```{r}
# fix names with spaces
 life_contrast%>% 
  ggplot() +
  # make a line plot with points for Australia
  geom_line(aes(Year, China, color = "China")) +
  geom_point(aes(Year, China, color = "China")) +
  # make a line plot with points for New_Zealand
  geom_line(aes(Year, Canada, color = "Canada")) +
  geom_point(aes(Year, Canada, color = "Canada")) +
  labs(y = "Life Expectency")
```

* Next I'll show the scatterplot that shows life expectancy for this two countries.
```{r}
life_contrast %>%
  ggplot(aes(China, Canada,color=factor(Year)))+
  geom_point()+
  xlim(40,85)+
  ylim(40,85)+
  coord_fixed()+
  geom_abline(intercept = 0, slope = 1)
  
```

# Join Prompts (join, merge, look up)

## Activity #1
* Problem: You have two data sources and you need info from both in one new data object.

* Solution: Perform a join, which borrows terminology from the database world, specifically SQL.

* Create a second data frame, complementary to Gapminder. Join this with (part of) Gapminder using a dplyr join function and make some observations about the process and result. Explore the different types of joins. Examples of a second data frame you could build:
* One row per country, a country variable and one or more variables with extra info, such as language spoken, NATO membership, national animal, or capitol city.
* One row per continent, a continent variable and one or more variables with extra info, such as northern versus southern hemisphere.

* country_codes in package gapminder is a good data frame for this situation. First, let's show the data in country_codes 
```{r}
country_codes %>% 
  head(30)%>%
  knitr::kable()
```

